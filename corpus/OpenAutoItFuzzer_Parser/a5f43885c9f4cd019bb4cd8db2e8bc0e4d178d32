If 1The[[[näenäElsE$dlse exit
$3$o
$v$vÿIf$6,I$E$e0$,Ifæ2ThenäElse exiFunc t($k)Func d($p)Func t($i)lse

$7,Ifæ2ThenäElse exit
$t$3$ÿIfæ2ThenäEdsE$d;
$3
$eÆIfæ0Thenä9lsE$v
$v$TÿIfæ2ThenäElsE$E[[[-[[[[[[$e$0,Ifæ2Thhex$t$3$6,Ifæ1ThenäEsle
l(.)xit*ÿ[$e$0,Ifæ2ThenäElse eE$v
$v$TÿIfæ2ThenäElsE$E[[[- t($k)Func d[[[[[[$e,Ifæ2ThenäElse
l()$0E$d$3
$7,Ifæ²Tt$3$ÿIfæ2ThenäEd
$v$TÿIfæÿÿÿ
näElsE$E[[[-[[[[[[$e$5,Tit*[$e$0,I.)$E$d$3$7,Ifæ3ThenäElse exit[Exit*[$e$0,Ifæ2ThenäElse exit
$3$$v
$v$TÿIfæ2ThenäElsE$E[[[-[[[[[[$e$0,If$d$3
$7,Ifæ2ThenäElse exit
$t$3$ÿIfFileSaveDialog
$<3
$eÆIfnäElsE$v
$v$TÿIfæ2ThenäElsE$EK[[-[[[[[[$e$0,Ifæ2ThenäElæ2ThenäElse exit
$eÆE[[[-[[[[[[$e$0,Ifæ2ThenäElse ^xit
$3$$t$36,Ifæ
l(.)xit*ÿ[$e$0,Ifæ2ThenäElse eE$v
$v$TÿIfæ2ThenäElsE$E[[[- t($k)Func d[[[[[[$e,Ifæ2ThenäElse
l()$0E$d$3
$7,Ifæ²Tt$3$ÿ$LE$d
$<4
$v
$TÿIfExæ2Then3$o
$v$vÿIf$6,>Ifæ2ThenäElse
l(enäElse
Wi