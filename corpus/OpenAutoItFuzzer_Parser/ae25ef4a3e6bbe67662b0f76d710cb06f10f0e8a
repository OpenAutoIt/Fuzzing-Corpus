If 1ThenLocal)
Local*
Local)
Local*
LocaL+
LocaL+
Local*
LocaL$l$TÿIfæ1ThenäElsE$d;;
$3$eÆIfæIsHWndElsE$v
$v$TÿIfæ2ThenäElsE$E$e$0,Ifæ2ThenäElse exit
$t$3$ÿIfæ2ThenäElsE$d;
$3
$eÆIfæ0ThenäElsE$v
$v$TÿIfæ2ThenäElsE$E$e$0,Ifæ2ThenäElse exit
$3$t
Local*
Local)
Locall()$E$d$3$7,Ifæ~ThenäE($l)c($u)
($l)d($v)F($l)$($c)
($v)c($u)$($c)
($v)F($l)$($l)d($l)
($v)l(lse ex;;
$3$eÆIfæIsHWndElsE$v
$v$TÿIfæ2ThenäElsE$E$e$0,Ilse exit
$t$3$ÿIfæ2ThenäElsE$d;
$3
$eÆIfæ0ThenäElsE$v
$v$TÿäElse exit
$l0$d$3$7ThealElsE$E$e$0,Ifæ2ThenäEls] exit
$3enäElshenäElse exit
$3enäElsE$e$$7,Ifæ3ThenäElse exit
$l0$d$3$7ThenäElsE$E$e$0,Ifæ2ThenäElse exit
$3enäElsE$æ2ThenäEl1ThenäElsE$d;;
$3$eÆIfæIsHWndElsE$v
$v$TÿIfæ2ThenäElsE$E$e$0,Ifæ2ThenäElse exit
$t$3$ÿIfæ2ThenäElsE$d;
$3
$eÆIfæ0ThenäElsE$v
$v$TÿIfæ2ThenäElsE$E$e$0,Ifæ2ThenäElse exit
$3$t
Local*
Local)
Locall()$E$d$3$7,Ifæ~ThenäElse exit
$LE$4
$v
$TÿIfæ2ThenäElsE$d$e
$0,Ifæ2ThenäElse exit
$3$o
$v$vÿIfæ2ThenäElsE$E$e$0,Ifæ2ThenäElse exit
$3$t$3$6,Ifæ2ThenäElse
l()$0E$d$3
$7,Ifæ3ThenäElse 
$l$l)$($c)
($v)F($l)$($l)d($l)$($c)
($v)F($l)$($l)$($l)
($l)$($c)
($v)F($l)$($l)d($l)$($c)
($v)FE$0$d$e exit
$3$t$3$6,Ifæ2ThenäElse
l()$0E$d$3
äElsE$d;
$3($l)$($l)$($l)l($v)F($l)$($c)
(
$eÆIfæ0ThenäE$v)c($u)$($c)
($v)F($l)lsE$v
$v$TÿIfæ2Then
äEl(